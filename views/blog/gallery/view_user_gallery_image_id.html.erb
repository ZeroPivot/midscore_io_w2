<!DOCTYPE html>
<html>
<head>
    <script>
    function toggleImageSize() {
        var image = document.getElementById("gallery-image");
        if (image.style.width === "50%") {
            image.style.width = "auto";
            image.style.height = "auto";
        } else {
            image.style.width = "50%";
            image.style.height = "auto";
        }
    }

    function fitToScreenSize() {
        var image = document.getElementById("gallery-image");
        image.style.width = "100%";
        image.style.height = "auto";
    }

    window.onload = function() {
        var image = document.getElementById("gallery-image");
        image.style.width = "50%";
    };
</script>
    <title><%= @user %> - <%= @image['title'] %></title>
    <style>
        .table {
            display: table;
            width: 100%;
            border-collapse: collapse;
        }
        .table-row {
            display: table-row;
        }
        .table-header {
            display: table-cell;
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            background-color: gray;
        }
        .table-data {
            display: table-cell;
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            background-color: black;
            color: gray;
        }
        .emoji {
            font-size: 20px;
            margin-right: 5px;
        }
    </style>
    <style>
        .image-container {
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid #ddd;
            padding: 10px;
        }
        .image-container img {
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
    <center><div>
        <form action="<%= "#{domain_name(@r)}/gallery/view/#{@user}/tags/search" %>" method="get">
            <input type="text" id="search_tags" name="search_tags" placeholder="Search tags" required>
            <a href="<%= "#{domain_name(@r)}/gallery/view/#{@user}/tags/" %>">(ğŸ·ï¸,ğŸ·ï¸,...)</a>
            <input type="submit" value="Search">
        </form>
    </div>
    </center>
    <br>
    <div class="image-container">
        <img id="gallery-image" src="<%= "#{domain_name(@r)}/gallery/#{@user}/resized_#{@image["file"]}" %>" onclick="toggleImageSize()" alt="<%= @title %>">
    </div>
    <center><button onclick="fitToScreenSize()">(ğŸ—œï¸)</button></center>
    <div class="table">
        <div class="table-row">
            <div class="table-header"><strong>(ğŸ§¾)</strong></div>
            <div class="table-data"><%= @image['title'] %></div>
        </div>
        <div class="table-row">
            <div class="table-header"><strong>(ğŸ“)</strong></div>
            <div class="table-data"><%= @image['description'] %></div>
        </div>
        <div class="table-row">
            <div class="table-header"><strong>(ğŸ·ï¸,ğŸ·ï¸,..)</strong></div>
            <div class="table-data"><%= parse_tags(user: @user, tag_string: @image['tags']) %></div>
        </div>
        <div class="table-row">
            <div class="table-header"><strong>(âŒš)</strong></div>
            <div class="table-data"><%= @image['date'] %></div>
        </div>
        <div class="table-row">
            <div class="table-header"><strong>(â™¾ï¸)</strong></div>
            <div class="table-data"><%= @image['views'] %></div>
        </div>
          <div class="table-row">
            <div class="table-header"><strong>OwO</strong>


            </div>
            <div class="table-data">
                <% if !@owo.nil? %>
                <%= convert_ints_to_emoji(@owo) %>
                <% else %>
                âŠ˜
                <% end %>


            <% if session['user'] %>
                <% log(session['user']) %>
                <% log(@owo.to_s) %>
                <% if @owo.nil? %>
                <a href="<%= "#{domain_name(@r)}/gallery/owo/add?image_id=#{@image['id']}" %>">(OwOğŸª¨)</a>
                <% else %>
                <a href="<%= "#{domain_name(@r)}/gallery/owo/add?image_id=#{@image['id']}" %>">(OwOâ•â•)</a> || <a href="<%= "#{domain_name(@r)}/gallery/owo/sub?image_id=#{@image['id']}" %>">(OwOâ–â–)</a> || <a href="<%= "#{domain_name(@r)}/gallery/owo/rem?image_id=#{@image['id']}" %>">(OwOğŸ”¨)</a>
                <% end %>
            <% end %>
            </div>
        </div>
          <div class="table-row">
            <div class="table-header"><strong>(â¬ğŸ’¾)</strong></div>
            <div class="table-data"><a href="<%= "#{domain_name(@r)}/gallery/#{@user}/#{@image["file"]}" %>">DOWNLOAD</a></div>
        </div>
          <div class="table-row">
            <div class="table-header"><strong>(ğŸ”—)</strong></div>
            <div class="table-data"><a href="<%= "#{domain_name(@r)}/gallery/view/#{@user}/id/#{@id}" %>">PERMA-LINK</a></div>
        </div>
        <div class="table-row">
            <div class="table-header"><strong>(ğŸ“)</strong></div>
            <div class="table-data"><a href="<%= "#{domain_name(@r)}/gallery/edit/#{@user}/id/#{@image["id"]}" %>">ADMIN: EDIT</a></div>
        </div>
          <div class="table-header"><strong>(ğŸ†”)</strong></div>
            <div class="table-data"><%= @id %></div>

              <div class="table-row">
                <% if @image["attachments"] && !@image["attachments"].empty? %>
                <div class="table-header"><strong>(ğŸ“)</strong></div>
                <div class="table-data">
                       <a href="<%= domain_name(@r) %>/gallery/view/<%= @user %>/id/<%= @id %>/attachments/">ATTACHMENTS LIST (ğŸ“)</a>
                </div>
                <% end %>
        </div>
    </div>
      <% if session['user'] %>  <center>  <a href = "<%= "#{domain_name(@r)}/gallery/view/#{@user}/id/#{@id}/attachments/upload" %>">UPLOAD ATTACHMENT</a> </center>

      <br>
      <% end %>
    <center>
        <a href="<%= "#{domain_name(@r)}/gallery/view/#{@user}" %>">Return to #{@user}'s Gallery</a>
    </center>
    <center>
        <script>
            function fitToScreenSize() {
                var image = document.getElementById("gallery-image");
                if (image.style.width === "100%") {
                    image.style.width = "50%";
                } else {
                    image.style.width = "100%";
                }
                image.style.height = "auto";
            }
        </script>
    </center>
</body>
</html>
