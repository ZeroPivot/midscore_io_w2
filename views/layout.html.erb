<%# family_logged_in(r) works if and only if $lockdown = true (CGMFS.rb; main loop) %>
<%= family_logged_in?(@r) %>


<% if @file %>
  <% @thumbnail_file = "#{domain_name(@r)}/thumbnail_#{@file}" %>
  <% else %>
  <% @thumbnail_file = "#{domain_name(@r)}/card" %>
<% end %>


<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title><%= @title %></title>
    <link rel="stylesheet" href="<%= domain_name(@r) %>/style.css" type="text/css" />    
    <link rel="shortcut icon" type="image/x-icon" href="<%= domain_name(@r) %>/favicon.ico">
    <!-- the embed cards don't embed images on bluesky; probably admin incompetance or a setting somewhere, but everything was tried at one time -->
    <meta property="og:site_name" content="miaedscore.online" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="<%= @title %> - by <%= @user %>" />
    <meta property="og:image" content="<%= @thumbnail_file %>" />
    <meta property="og:url" content="<%= domain_name(@r) %>/<%= @type %>/<%= @user %>/view/<%= @id %>" />
    <meta property="og:description" content="Post By <%= @description || @title || @user %>" />
    <meta name="description" content="Post By <%= @description || @title || @user %>" />
    <meta name="keywords" content="stimky.info, info, stinky info, stimky info, onlyfurs, only furs, onlyfans, porn, pr0n, pornography, nsfw, sfw, gay, homosexual, faggot, faggotry, stinky faggotry, stimky faggotry, stinky stimky champions, champions, gods of stink, gods of musk, gods of stimk, stinky gods, stinky wolf gods, stinky dogg gods, stinky yeen gods, miaedscore.online, miaedscore, miaed-score, vore, vorny, musk, musky, stinky, stimky, acetone, stinky acetone, stinky stimky champions, codename sniffa, sniffa, demiurge, simulation, simulator, sim, second life, stinky, stimky, stinky.zip, stimky.zip onemoondogg, pornography, porn, pron, pr0n, furry porn, vore, cock vore, anal vore, galleries, deviantart, furaffinity, midscore, mid, mids, midscorian, wolf, one moon planet, onemoonplane, blog,  gamedev, gamedevelopment, indiegamedev, game, api, anthro, anthropomorphic, dragon, dragons, furry, furries, comic, comics, web, webcomic, dreamsigns, addictions, earth, planets, war, science, sciencefiction, wolf, wolves, lynx, fennec, fox, foxes, gallery, anthro, anthropomorphic, commission, commissions, actors, manedwolf, maned_wolf, canines, canids, fennecfox, future, german shepherd, axelshep, aylocollie, furryfurry, nsfw, gay, homosexual, faggotry, market, commissions, algorithm, simulator earth, simulation, role playing game, rpg, actors: simulator, actors: simula, simula, programming, coding, computer science rockstars, comp sci rockstars, computer science, computer information systems, mathematics, calculus, physics, furry artist, artist, canid, canines, role playing game, role-playing game, blog, journal, cdn, api, gallery, furry blog, furry gallery, emojis, emoji, collie, german shepherd, gshep, g-shep, hyena, yeen, striped hyena, aardwolf, spotted hyena, mathematics, discrete mathematics, phd, gaymer, furfag, furfaggotry, nsfl, flcl, anime, style, art style, artistry, digital art, zoophile hunters, pedophile hunters, bigot hunters, trans hunters, trans exposers, bigot exposers, pedophile exposers, democrat, republican, cenrist, democrat lol, sexy, signup, mega-game.net, meta game, meta, metaworld, furfaggotry, blogger, blog, gnosis, gnostic, gnocticism, ai, artificlal intelligence, service, blogger, gallery, furry gallery, furry bloggers, furry blogger, gay, homosexual, queer, twin flames, rhuxwolf, aylowolf, rhuxfolf, aylofolf, metagame, game, gaming, games, video games, software, hardware" />
    <meta name="author" content="Miaede-Score">  
    <meta name="twitter:card" content="summary_large_image" /> <!-- changed 2021-04-15 -->
    <meta name="twitter:site" content="Miaedscore.online" />
    <meta name="twitter:title" content="<%= @title %>" />
    <meta name="twitter:url" content="<%= domain_name(@r) %>/<%= @type %>/<%= @user %>/view/<%= @id %>" />
    <meta name="twitter:description" content="<%=h @description || @title || @user %>" />
    <meta name="twitter:image" content="<%= @thumbnail_file %>" />
    <meta name="twitter:creator" content="@Miaedscore" />
    <meta name="twitter:domain" content="miaedscore.online"/>
    <meta property="bsky:card" content="summary_large_image">
    <meta property="bsky:site" content="araety.org"> <!-- Replace with your Bluesky handle if available -->
    <meta property="bsky:title" content="<%= @title %>">
    <meta property="bsky:description" content="<%=h @description || @title || @user %>">
    <meta property="bsky:image" content="https://miaedscore.online/card">
    <meta name="msvalidate.01" content="AAA4058A3DABDECA9018AD89DD143C68" />
  </head>
  <body>
  <style>

body {
	color: white;
    background-color: rgb(85, 115, 145);
	font-size: 16px;
	font-family: Arial, Helvetica, sans-serif;

}

.text
{
	color: white;
	background-color: lightslategray;
	font-size: 18px;
	font-family: Arial, Helvetica, sans-serif;
}

.container {
	display: flex;
}

.node {
	flex: 1;
	flex-basis: auto;
}

a:link {
	color:rgb(39, 38, 38);

}

a:visited {
	color:rgb(255, 255, 255);
}

a:active {
	color:red;
}

div.galleryTable {
  width: 100%;
  height: 100%;
  font-size: 1;

}

.divTable.galleryTable .divTableCell, .divTable.galleryTable .divTableHead {

}
.divTable{ display: table; }
.divTableRow { display: table-row; }
.divTableHeading { display: table-header-group;}
.divTableCell, .divTableHead { display: table-cell;}
.divTableHeading { display: table-header-group;}
.divTableFoot { display: table-footer-group;}
.divTableBody { display: table-row-group;}
.day { border: 1px solid black; padding: 10px; display: inline-block; width: 40px; text-align: center; }
.week { clear: both; }
  </style>    
  <div>
  <center>
  <br>
  <a href="<%= domain_name(@r) %>/blog/<%= @user %>">
    <div style="font-size: 72px; overflow-wrap: break-word;">
      1ï¸âƒ£ğŸŒ“ğŸŒ
    </div>
  </a>
  <font size="16"><a href="<%= domain_name(@r) %>/blog">(ğŸ“ƒ)</a>,<a href="<%= domain_name(@r) %>/gallery">(ğŸ–¼ï¸)</a></font><br><br>
  <font size="3"><%= SolarDance.sun_dance_message %></font><br>
  <font size="3"><%= "Gregorian: #{Calendar.new.gregorian}" %><font><br>
  <font size="3"><%= "Julian: #{Calendar.new.julian_primitive} -> #{Calendar.new.julian}" %></font><br>
  <% @ae_calendar = AECalendar.new %>
  <font size="3"><%= "AE Calendar: #{@ae_calendar.ae_date(DateTime.now)}" %></font><br>
  <%= "<font size=\"4\">#{MoonPhaseDetails.print_details_for_date(Date.today)}</font>" %>
  <b>120</b>ğŸ•°ï¸<%= convert_to_120_second_time_pst  %> PST
  <hr>
 <br>
  <% if session['user'] %>
   <h1>(ğŸ‘¤[<a href="/gallery/upload">(ğŸ”¢)</a>; <a href="/gallery/upload/url">(ğŸ”—ğŸ”¢)</a>;  <a href="/blog/<%= session['user'] %>/new">(ğŸ“)</a>|<a href="/gallery/view/<%= session['user'] %>">(ğŸ–¼ï¸)</a>],[<a href="/blog/<%= session['user'] %>">(ğŸ“ƒ)</a>]) <a href="/gallery/view/<%= session['user'] %>"><%= session['user'] %></a></h1><br>
  <% end %>
  <br>
  </center>
  </div>
  <br>
    <%= yield %>
    <%= assets(:js) %>
  </body>
  <center>
  <hr>
  <font face="consolas">
  <% stop_rendering_time = Time.now.to_f %>
  <b></b> ğŸ“ <%= ((stop_rendering_time - @start_rendering_time.to_f)).round(5) %>s [<%= ((stop_rendering_time - @start_rendering_time.to_f)*1000).round(5) %>ms]<br><br>

<% if !@page_views %>
  <% File.open("/home/midscore_io/views/page_views.txt", "r+") do |file| %>
    <% @page_views = file.read.to_i %>
    <% @page_views += 1 %>
    <% file.rewind %>
    <% file.write(@page_views) %>
  <% end unless LOCAL %>
<% end %>
<% if LOCAL %>
   <% File.open("views/page_views_local.txt", "r+") do |file| %>
    <% @page_views = file.read.to_i %>
    <% @page_views += 1 %>
    <% file.rewind %>
    <% file.write(@page_views) %>
  <% end %>
  <% end %>
<br>
â™¾ï¸<%= @page_views.to_s.reverse.gsub(/(\d{3})(?=\d)/, '\\1,').reverse %> -- (c)Miaed-Score -- <%= $dog_blog_version %><br>
<br />
<center><%= formatted_pst_time %></center>
<br />


<br>
<br>
<br>
<center><font size="3"><div size="5" id="ip_addr_resolv">ğŸ˜ï¸<b>[ğŸŒ<%= request.ip %>]</b></div></font></center>
<br>
<a href="<%= domain_name(@r) %>/blog/login">[â•ğŸ”’]</a>|<a href="<%= domain_name(@r) %>/blog/logout">[â–ğŸ”’]</a><br>
</center>
</html>

<% if @r %>
<%

# make sure the files exist no matter what
FileUtils.touch("./main_request_log.txt")
FileUtils.touch('./hitches.txt')

 @hitch_cookie = @r.params['h']
      @hitch_cookie = '' if @hitch_cookie.nil? || @hitch_cookie.empty? || @hitch_cookie == 'undefined'
      #@hitch_cookie = @hitch_cookie.gsub(/[^a-zA-Z0-9]/, '') # Sanitize the hitch cookie to allow only alphanumeric characters
      Thread.new do
      File.open('./hitches.txt', 'a') { |f| f.puts("#{request.ip} - #{Time.now.to_s} - #{@hitch_cookie}\n") }
      end 


      %>

      

<% File.open('main_request_log.txt', 'a') do |f| %>

     <%
      # Log the request method
      f.puts "request_method: #{@r.request_method}"

      # Log the host
      f.puts "host: #{@r.host}"

      f.puts "ip: #{@r.ip}"

      # Log the path
      f.puts "path: #{@r.path}"

      # Log the GET parameters
      f.puts "GET_params: #{@r.GET}"

      # Log the POST parameters
      f.puts "POST_params: #{@r.POST}"
      begin
        hostname = Resolv.getname(request.ip) if $resolv
        f.puts "hostname: #{hostname}" if $resolv
      rescue Resolv::ResolvError
        f.puts "hostname: unknown" if $resolv
      end
      f.puts "AJAX request? #{@r.xhr?}"
      f.puts "cookies: #{@r.cookies}"
      f.puts "REFERRER: #{@r.referrer}"
      f.puts "timestamp: #{TZInfo::Timezone.get('America/Los_Angeles').utc_to_local(Time.now)}"
      f.puts "User-Agent: #{@r.user_agent}"
      f.puts "Timestamp (UTC): #{Time.now.utc}"

      f.puts #newline
      # ... add more logs as needed ...

      %>
<% end %>
    <% end %>


   

<br><br>
<br />
<br />
<br />
  <center><pre>    # The 23 fabled moon rotations with emojis:
        MOON_ROTATIONS = [
          'New Moon ğŸŒ‘',            # 0
          'Waxing Crescent ğŸŒ’',     # 1
          'First Quarter ğŸŒ“',       # 2
          'Waxing Gibbous ğŸŒ”', # 3
          'Full Moon ğŸŒ•',           # 4
          'Waning Gibbous ğŸŒ–',      # 5
          'Last Quarter ğŸŒ—',        # 6
          'Waning Crescent ğŸŒ˜',     # 7
          'Supermoon ğŸŒ',           # 8
          'Blue Moon ğŸ”µğŸŒ™',         # 9
          'Blood Moon ğŸ©¸ğŸŒ™',        # 10
          'Harvest Moon ğŸ‚ğŸŒ•',      # 11
          "Hunter's Moon ğŸŒ™ğŸ”­",     # 12
          'Wolf Moon ğŸºğŸŒ•',         # 13
          'Pink Moon ğŸŒ¸ğŸŒ•',
          'Snow Moon ğŸŒ¨ï¸',          # 14
          'Snow Moon Snow ğŸŒ¨ï¸â„ï¸',    # 15
          'Avian Moon ğŸ¦…',          # 16
          'Avian Moon Snow ğŸ¦…â„ï¸',    # 17
          'Skunk Moon ğŸ¦¨',           # 18
          'Skunk Moon Snow ğŸ¦¨â„ï¸',    # 19
        ]

        # Define 23 corresponding species with emojis.
        SPECIES = [
          'Dogg ğŸ¶', # New Moon
          'Folf ğŸ¦ŠğŸº', # Waxing Crescent
          'Aardwolf ğŸ¾',                 # First Quarter
          'Spotted Hyena ğŸ†',            # Waxing Gibbous
          'Folf Hybrid ğŸ¦Šâœ¨',             # Full Moon
          'Striped Hyena ğŸ¦“',            # Waning Gibbous
          'Dogg Prime ğŸ•â­',              # Last Quarter
          'WolfFox ğŸºğŸ¦Š', # Waning Crescent
          'Brown Hyena ğŸ¦´',              # Supermoon
          'Dogg Celestial ğŸ•ğŸŒŸ',          # Blue Moon
          'Folf Eclipse ğŸ¦ŠğŸŒ’',            # Blood Moon
          'Aardwolf Luminous ğŸ¾âœ¨', # Harvest Moon
          'Spotted Hyena Stellar ğŸ†â­', # Hunter's Moon
          'Folf Nova ğŸ¦ŠğŸ’¥', # Wolf Moon
          'Brown Hyena Cosmic ğŸ¦´ğŸŒŒ', # Pink Moon
          'Snow Leopard ğŸŒ¨ï¸', # New Moon
          'Snow Leopard Snow Snep ğŸŒ¨ï¸â„ï¸', # Pink Moon
          'Avian ğŸ¦…', # New Moon
          'Avian Snow ğŸ¦…â„ï¸', # Pink Moon
          'Skunk ğŸ¦¨', # New Moon
          'Skunk Snow ğŸ¦¨â„ï¸', # New Moon
        ]

        # Define 23 corresponding were-forms with emojis.
        WERE_FORMS = [
          'WereDogg ğŸ¶ğŸŒ‘',                     # New Moon
          'WereFolf ğŸ¦ŠğŸŒ™',                     # Waxing Crescent
          'WereAardwolf ğŸ¾',                   # First Quarter
          'WereSpottedHyena ğŸ†',               # Waxing Gibbous
          'WereFolfHybrid ğŸ¦Šâœ¨',                # Full Moon
          'WereStripedHyena ğŸ¦“',               # Waning Gibbous
          'WereDoggPrime ğŸ•â­',                 # Last Quarter
          'WereWolfFox ğŸºğŸ¦Š', # Waning Crescent
          'WereBrownHyena ğŸ¦´',                 # Supermoon
          'WereDoggCelestial ğŸ•ğŸŒŸ',             # Blue Moon
          'WereFolfEclipse ğŸ¦ŠğŸŒ’',               # Blood Moon
          'WereAardwolfLuminous ğŸ¾âœ¨',          # Harvest Moon
          'WereSpottedHyenaStellar ğŸ†â­',       # Hunter's Moon
          'WereFolfNova ğŸ¦ŠğŸ’¥', # Wolf Moon
          'WereBrownHyenaCosmic ğŸ¦´ğŸŒŒ', # Pink Moon
          'WereSnowLeopard ğŸ†â„ï¸',
          'WereSnowLeopardSnow ğŸ†â„ï¸â„ï¸', # Pink Moon
          'WereAvian ğŸ¦…', # New Moon
          'WereAvianSnow ğŸ¦…â„ï¸', # Pink Moon
          'WereSkunk ğŸ¦¨', # New Moon
          'WereSkunkSnow ğŸ¦¨â„ï¸' # New Moon

        ]
</pre>
</center>

<br><br><br><br><br>






<iframe src="https://furaffinity.net/user/artywalf" width="0" height="0"></iframe>
<iframe src="https://furaffinity.net/user/lukereinhard" width="0" height="0"></iframe>
<iframe src="https://furaffinity.net/user/genericdefault" width="0" height="0"></iframe>


